{% extends "base.html" %}

{% block title %}テーブル一覧 - DBメンテ{% endblock %}

{% block head %}
<style>
  .page-title { font-size: 18px; font-weight: bold; margin: 0 0 16px 0; padding-bottom: 8px; border-bottom: 2px solid #333; }
  .search-form { background: #f5f5f5; padding: 12px; margin-bottom: 16px; border: 1px solid #ddd; }
  .search-form label { display: inline-block; width: 120px; font-weight: bold; }
  .search-form input { padding: 4px 8px; margin-right: 16px; width: 150px; }
  .search-form button { padding: 6px 16px; margin-left: 8px; }
  .search-row { margin-bottom: 8px; }
  .table-list { width: 100%; border-collapse: collapse; }
  .table-list th, .table-list td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  .table-list th { background: #e8eefa; }
  .table-list tr:hover { background: #f5f5f5; }
  .table-link { color: #0066cc; text-decoration: none; }
  .table-link:hover { text-decoration: underline; }
  .no-data { color: #666; font-style: italic; padding: 16px 0; }
  .nav-links { margin-top: 16px; }
  .nav-links a { color: #0066cc; text-decoration: none; }
  .nav-links a:hover { text-decoration: underline; }
  .result-count { font-size: 13px; color: #666; margin-bottom: 8px; }
</style>
{% endblock %}

{% block content %}
<div class="page-title">テーブル一覧 (Z101)</div>

<div class="search-form">
  <form method="get" action="/table/list">
    <div class="search-row">
      <label>システム区分:</label>
      <input type="text" name="sys" value="{{ search_sys }}" placeholder="例: Z">
      <label>種別:</label>
      <input type="text" name="shu" value="{{ search_shu }}" placeholder="例: M">
    </div>
    <div class="search-row">
      <label>テーブルID:</label>
      <input type="text" name="tblnm" value="{{ search_tblnm }}" placeholder="部分一致">
      <label>テーブル名称:</label>
      <input type="text" name="tbljnm" value="{{ search_tbljnm }}" placeholder="部分一致">
    </div>
    <div class="search-row">
      <button type="submit">検索</button>
      <button type="button" onclick="location.href='/table/list'">クリア</button>
    </div>
  </form>
</div>

{% if tables %}
<p class="result-count">{{ tables|length }}件</p>
<table class="table-list">
  <thead>
    <tr>
      <th>区分</th>
      <th>種別</th>
      <th>テーブルID</th>
      <th>テーブル名称</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for table in tables %}
    <tr>
      <td>{{ table.sys }}</td>
      <td>{{ table.shu }}</td>
      <td>{{ table.tblnm }}</td>
      <td>{{ table.tbljnm }}</td>
      <td><a class="table-link" href="/table/maintenance?tblnm={{ table.tblnm }}">項目定義</a></td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p class="no-data">テーブル定義が見つかりません。検索条件を変更するか、Oracle接続を確認してください。</p>
{% endif %}

<div class="nav-links">
  <a href="/menu">メニューへ戻る</a>
</div>
{% endblock %}
